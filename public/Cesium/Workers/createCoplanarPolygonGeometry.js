define(["./arrayRemoveDuplicates-053c1528","./BoundingRectangle-beed7718","./buildModuleUrl-c881a5f0","./Cartesian2-4a5e3b0e","./Cartographic-dafe811b","./Check-07c613bc","./ComponentDatatype-662c7548","./CoplanarPolygonGeometryLibrary-0780bd94","./when-207a1520","./Rectangle-49e286b5","./GeometryAttribute-9a541822","./GeometryAttributes-d4cebc09","./GeometryInstance-861a06a2","./GeometryPipeline-35f216f8","./IndexDatatype-447558fc","./Math-bae672f2","./PrimitiveType-44685a19","./PolygonGeometryLibrary-40859599","./PolygonPipeline-63f52c70","./VertexFormat-ac4b93af","./Intersect-4d67bbf5","./Event-2ef149d9","./RuntimeError-b98f87df","./WebGLConstants-8d1e45f7","./OrientedBoundingBox-dd9541f0","./Cartesian4-58d59766","./EllipsoidTangentPlane-fb04e18c","./IntersectionTests-37198421","./Plane-e266b3a4","./Buffer-bf3c9fbe","./RenderState-f1428610","./Color-03dac52c","./FeatureDetection-fc084259","./WindingOrder-380ced54","./AttributeCompression-f9972ce8","./EncodedCartesian3-3f2a160d","./ArcType-198c1070","./EllipsoidRhumbLine-b1de3107"],(function(e,t,n,o,a,r,i,c,p,s,l,y,u,d,g,m,v,f,h,b,w,A,P,x,T,D,F,_,k,L,E,C,R,I,H,G,O,B){"use strict";var z=new a.t,S=new t.f,N=new o.o,j=new o.o,M=new a.t,U=new a.t,V=new a.t,W=new a.t,Y=new a.t,q=new a.t,J=new l.n,Q=new v.p,Z=new v.p,K=new a.t;function X(e,t,n,r,c,p,s,u){var d=e.positions,f=h.A.triangulate(e.positions2D,e.holes);f.length<3&&(f=[0,1,2]);var b=g.IndexDatatype.createTypedArray(d.length,f.length);b.set(f);var w=Q;if(0!==r){var A=l.n.fromAxisAngle(p,r,J);if(w=v.p.fromQuaternion(A,w),t.tangent||t.bitangent){A=l.n.fromAxisAngle(p,-r,J);var P=v.p.fromQuaternion(A,Z);s=a.t.normalize(v.p.multiplyByVector(P,s,s),s),t.bitangent&&(u=a.t.normalize(a.t.cross(p,s,u),u))}}else w=v.p.clone(v.p.IDENTITY,w);var x=j;t.st&&(x.x=n.x,x.y=n.y);for(var T=d.length,D=3*T,F=new Float64Array(D),_=t.normal?new Float32Array(D):void 0,k=t.tangent?new Float32Array(D):void 0,L=t.bitangent?new Float32Array(D):void 0,E=t.st?new Float32Array(2*T):void 0,C=0,R=0,I=0,H=0,G=0,O=0;O<T;O++){var B=d[O];if(F[C++]=B.x,F[C++]=B.y,F[C++]=B.z,t.st){var S=c(v.p.multiplyByVector(w,B,z),N);o.o.subtract(S,x,S);var M=m.e.clamp(S.x/n.width,0,1),U=m.e.clamp(S.y/n.height,0,1);E[G++]=M,E[G++]=U}t.normal&&(_[R++]=p.x,_[R++]=p.y,_[R++]=p.z),t.tangent&&(k[H++]=s.x,k[H++]=s.y,k[H++]=s.z),t.bitangent&&(L[I++]=u.x,L[I++]=u.y,L[I++]=u.z)}var V=new y.a;return t.position&&(V.position=new l.o({componentDatatype:i.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:F})),t.normal&&(V.normal=new l.o({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:_})),t.tangent&&(V.tangent=new l.o({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:k})),t.bitangent&&(V.bitangent=new l.o({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:3,values:L})),t.st&&(V.st=new l.o({componentDatatype:i.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:E})),new l.I({attributes:V,indices:b,primitiveType:v._0x102869.TRIANGLES})}function $(e){var t=(e=p.u(e,p.u.EMPTY_OBJECT)).polygonHierarchy;r.o.defined("options.polygonHierarchy",t);var n=p.u(e.vertexFormat,b.n.DEFAULT);this._vertexFormat=b.n.clone(n),this._polygonHierarchy=t,this._stRotation=p.u(e.stRotation,0),this._ellipsoid=s.t.clone(p.u(e.ellipsoid,s.t.WGS84)),this._workerName="createCoplanarPolygonGeometry",this.packedLength=f.y.computeHierarchyPackedLength(t)+b.n.packedLength+s.t.packedLength+2}$.fromPositions=function(e){return e=p.u(e,p.u.EMPTY_OBJECT),r.o.defined("options.positions",e.positions),new $({polygonHierarchy:{positions:e.positions},vertexFormat:e.vertexFormat,stRotation:e.stRotation,ellipsoid:e.ellipsoid})},$.pack=function(e,t,n){return r.o.typeOf.object("value",e),r.o.defined("array",t),n=p.u(n,0),n=f.y.packPolygonHierarchy(e._polygonHierarchy,t,n),s.t.pack(e._ellipsoid,t,n),n+=s.t.packedLength,b.n.pack(e._vertexFormat,t,n),n+=b.n.packedLength,t[n++]=e._stRotation,t[n]=e.packedLength,t};var ee=s.t.clone(s.t.UNIT_SPHERE),te=new b.n,ne={polygonHierarchy:{}};return $.unpack=function(e,t,n){r.o.defined("array",e),t=p.u(t,0);var o=f.y.unpackPolygonHierarchy(e,t);t=o.startingIndex,delete o.startingIndex;var a=s.t.unpack(e,t,ee);t+=s.t.packedLength;var i=b.n.unpack(e,t,te);t+=b.n.packedLength;var c=e[t++],l=e[t];return p.e(n)||(n=new $(ne)),n._polygonHierarchy=o,n._ellipsoid=s.t.clone(a,n._ellipsoid),n._vertexFormat=b.n.clone(i,n._vertexFormat),n._stRotation=c,n.packedLength=l,n},$.createGeometry=function(t){var o=t._vertexFormat,r=t._polygonHierarchy,i=t._stRotation,p=r.positions;if(!((p=e.D(p,a.t.equalsEpsilon,!0)).length<3)){var s=M,y=U,v=V,h=Y,b=q;if(c.g.computeProjectTo2DArguments(p,W,h,b)){if(s=a.t.cross(h,b,s),s=a.t.normalize(s,s),!a.t.equalsEpsilon(W,a.t.ZERO,m.e.EPSILON6)){var w=t._ellipsoid.geodeticSurfaceNormal(W,K);a.t.dot(s,w)<0&&(s=a.t.negate(s,s),h=a.t.negate(h,h))}var A=c.g.createProjectPointsTo2DFunction(W,h,b),P=c.g.createProjectPointTo2DFunction(W,h,b);o.tangent&&(y=a.t.clone(h,y)),o.bitangent&&(v=a.t.clone(b,v));var x=f.y.polygonsFromHierarchy(r,A,!1),T=x.hierarchy,D=x.polygons;if(0!==T.length){p=T[0].outerRing;for(var F=n.i.fromPoints(p),_=f.y.computeBoundingRectangle(s,P,p,i,S),k=[],L=0;L<D.length;L++){var E=new u.d({geometry:X(D[L],o,_,i,P,s,y,v)});k.push(E)}var C=d.k.combineInstances(k)[0];C.attributes.position.values=new Float64Array(C.attributes.position.values),C.indices=g.IndexDatatype.createTypedArray(C.attributes.position.values.length/3,C.indices);var R=C.attributes;return o.position||delete R.position,new l.I({attributes:R,indices:C.indices,primitiveType:C.primitiveType,boundingSphere:F})}}}},function(e,t){return p.e(t)&&(e=$.unpack(e,t)),$.createGeometry(e)}}));
