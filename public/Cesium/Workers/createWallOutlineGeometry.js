define(["./when-207a1520","./Rectangle-49e286b5","./buildModuleUrl-c881a5f0","./Cartographic-dafe811b","./ComponentDatatype-662c7548","./Check-07c613bc","./GeometryAttribute-9a541822","./GeometryAttributes-d4cebc09","./IndexDatatype-447558fc","./Math-bae672f2","./PrimitiveType-44685a19","./WallGeometryLibrary-30613140","./Intersect-4d67bbf5","./Event-2ef149d9","./RuntimeError-b98f87df","./WebGLConstants-8d1e45f7","./Cartesian2-4a5e3b0e","./FeatureDetection-fc084259","./Cartesian4-58d59766","./arrayRemoveDuplicates-053c1528","./PolylinePipeline-7fefa20c","./EllipsoidGeodesic-a38ba139","./EllipsoidRhumbLine-b1de3107","./IntersectionTests-37198421","./Plane-e266b3a4"],(function(e,t,i,n,r,o,a,s,m,u,l,p,h,d,c,f,g,y,v,_,w,A,b,H,x){"use strict";var E=new n.t,k=new n.t;function D(i){var r=(i=e.u(i,e.u.EMPTY_OBJECT)).positions,a=i.maximumHeights,s=i.minimumHeights;if(!e.e(r))throw new o.t("options.positions is required.");if(e.e(a)&&a.length!==r.length)throw new o.t("options.positions and options.maximumHeights must have the same length.");if(e.e(s)&&s.length!==r.length)throw new o.t("options.positions and options.minimumHeights must have the same length.");var m=e.u(i.granularity,u.e.RADIANS_PER_DEGREE),l=e.u(i.ellipsoid,t.t.WGS84);this._positions=r,this._minimumHeights=s,this._maximumHeights=a,this._granularity=m,this._ellipsoid=t.t.clone(l),this._workerName="createWallOutlineGeometry",this._outlineWidth=e.u(i.outlineWidth,1);var p=1+r.length*n.t.packedLength+2;e.e(s)&&(p+=s.length),e.e(a)&&(p+=a.length),this.packedLength=p+t.t.packedLength+2}D.pack=function(i,r,a){if(!e.e(i))throw new o.t("value is required");if(!e.e(r))throw new o.t("array is required");a=e.u(a,0);var s,m=i._positions,u=m.length;for(r[a++]=u,s=0;s<u;++s,a+=n.t.packedLength)n.t.pack(m[s],r,a);var l=i._minimumHeights;if(u=e.e(l)?l.length:0,r[a++]=u,e.e(l))for(s=0;s<u;++s)r[a++]=l[s];var p=i._maximumHeights;if(u=e.e(p)?p.length:0,r[a++]=u,e.e(p))for(s=0;s<u;++s)r[a++]=p[s];return t.t.pack(i._ellipsoid,r,a),a+=t.t.packedLength,r[a++]=i._granularity,r[a]=i._outlineWidth,r};var L=t.t.clone(t.t.UNIT_SPHERE),P={positions:void 0,minimumHeights:void 0,maximumHeights:void 0,ellipsoid:L,granularity:void 0,outlineWidth:void 0};return D.unpack=function(i,r,a){if(!e.e(i))throw new o.t("array is required");r=e.u(r,0);var s,m,u,l=i[r++],p=new Array(l);for(s=0;s<l;++s,r+=n.t.packedLength)p[s]=n.t.unpack(i,r);if((l=i[r++])>0)for(m=new Array(l),s=0;s<l;++s)m[s]=i[r++];if((l=i[r++])>0)for(u=new Array(l),s=0;s<l;++s)u[s]=i[r++];var h=t.t.unpack(i,r,L);r+=t.t.packedLength;var d=i[r++],c=i[r];return e.e(a)?(a._positions=p,a._minimumHeights=m,a._maximumHeights=u,a._ellipsoid=t.t.clone(h,a._ellipsoid),a._granularity=d,a._outlineWidth=c,a):(P.positions=p,P.minimumHeights=m,P.maximumHeights=u,P.granularity=d,P.outlineWidth=c,new D(P))},D.fromConstantHeights=function(t){var i=(t=e.u(t,e.u.EMPTY_OBJECT)).positions;if(!e.e(i))throw new o.t("options.positions is required.");var n,r,a=t.minimumHeight,s=t.maximumHeight,m=e.e(a),u=e.e(s);if(m||u){var l=i.length;n=m?new Array(l):void 0,r=u?new Array(l):void 0;for(var p=0;p<l;++p)m&&(n[p]=a),u&&(r[p]=s)}return new D({positions:i,maximumHeights:r,minimumHeights:n,ellipsoid:t.ellipsoid})},D.createGeometry=function(t){var o=t._positions,h=t._minimumHeights,d=t._maximumHeights,c=t._granularity,f=t._ellipsoid,g=p.D.computePositions(f,o,d,h,c,!1);if(e.e(g)){var y=g.pos.bottomPositions,v=g.pos.topPositions,_=v.length;if(t._outlineWidth>1){let e=_/3;var w=3*(2*(2*e-2)+1),A=new Float64Array(w),b=0;let t,i,r;for(_=e,t=0;t<_;++t){var H=3*t;i=n.t.fromArray(v,H,E),r=n.t.fromArray(y,H,k),0!==t&&(A[b++]=i.x,A[b++]=i.y,A[b++]=i.z),A[b++]=r.x,A[b++]=r.y,A[b++]=r.z,A[b++]=i.x,A[b++]=i.y,A[b++]=i.z}for(b-=3,t=_-2;t>=0;--t){H=3*t;r=n.t.fromArray(y,H,k),A[b++]=r.x,A[b++]=r.y,A[b++]=r.z}}else{var x;w=2*_,A=new Float64Array(w),b=0;for(_/=3,x=0;x<_;++x){H=3*x;var D=n.t.fromArray(v,H,E),L=n.t.fromArray(y,H,k);A[b++]=L.x,A[b++]=L.y,A[b++]=L.z,A[b++]=D.x,A[b++]=D.y,A[b++]=D.z}var P=new s.a({position:new a.o({componentDatatype:r.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:A})})}P=new s.a({position:new a.o({componentDatatype:r.ComponentDatatype.DOUBLE,componentsPerAttribute:3,values:A})});t._outlineWidth>1&&(P.sideness=new a.o({componentDatatype:r.ComponentDatatype.FLOAT,componentsPerAttribute:2,values:new Float32Array([0,0,0,1,1,1,1,0])}),P.sideness.isInstanceAttribute=!0);var W=w/3;w=2*W-4+W;var C=m.IndexDatatype.createTypedArray(W,w),G=0;for(x=0;x<W-2;x+=2){var I=x,T=x+2,R=n.t.fromArray(A,3*I,E),O=n.t.fromArray(A,3*T,k);if(!n.t.equalsEpsilon(R,O,u.e.EPSILON10)){var S=x+1,q=x+3;C[G++]=S,C[G++]=I,C[G++]=S,C[G++]=q,C[G++]=I,C[G++]=T}}return C[G++]=W-2,C[G++]=W-1,new a.I({attributes:P,indices:C,primitiveType:t._outlineWidth>1?l._0x102869.TRIANGLES:l._0x102869.LINES,boundingSphere:new i.i.fromVertices(A)})}},function(i,n){return e.e(n)&&(i=D.unpack(i,n)),i._ellipsoid=t.t.clone(i._ellipsoid),D.createGeometry(i)}}));
